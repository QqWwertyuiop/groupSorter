<head>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:ital,opsz,wght@0,6..12,600;1,6..12,600&display=swap" rel="stylesheet">
	
	<style>
		* {
			color: rgb(255, 255, 255);
			background-color:rgb(96, 96, 96);
			font-family: "Nunito Sans", sans-serif;
			text-align: center;
			border: 4px;
			border-radius: 8px;
		}

		html {
			display: flex;
		}

		body {
			background-color:rgb(64, 64, 64);
			padding: 24px;
			flex-grow: 1;
		}

		label {
			background-color: rgba(0, 0, 0, 0);
			font-size: x-large;
		}

		textarea, select, input {
			font-size: medium;
		}

		#names {
			width:100%;
		}

		:root {
			--textHeightCurrent: 0px
			--textHeightNew: 0px
		}

		@keyframes appear {
			0% {
				height: 0px;
				color: transparent;
				padding-top: 0px;
				padding-bottom: 0px;
			}
			90% {
				height: var(--textHeightNew);
				color: rgba(255, 255, 255, 64);
				padding-top: 9px;
				padding-bottom: 9px;
			}
			100% {
				height: var(--textHeightNew);
				color:rgb(255, 255, 255);
				padding-top: 10px;
				padding-bottom: 10px;
			}
		}

		@keyframes appear {
			from {
				height: var(--textHeightCurrent);
				color: rgb(255, 255, 255);
			}
			to {
				height: var(--textHeightNew);
				color:rgb(255, 255, 255);
			}
		}

		.textAppear {
			animation: appear 1s ease 0s 1 normal forwards;
		}

		.textTransition {
			animation: transition 1s ease 0s 1 normal forwards;
		}

		.noPad {
			padding: 0px;
		}

		#text {
			font-size: medium;
			width: 100%;
			height: 0%;
			color: transparent;
		}

		::placeholder {
			color:lightgray;
		}

		#confetti {
			background-color: transparent;
		}

		canvas {
			background-color: transparent;
		}

		input {
			width: min-content;
		}

		label {
			width: 100%;
			margin-bottom: 16px;
		}

		p {
			padding-top: 10px;
			padding-bottom: 10px;
			margin: 0px;
		}
	</style>
	<script src="https://cdn.jsdelivr.net/npm/@tsparticles/confetti@3.0.3/tsparticles.confetti.bundle.min.js"></script>
</head>
<body style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
	<label for="names"><p>GroupSorter</p></label>
	<p id="text" class="noPad"></p>
	<textarea id="names" name="names" style="resize: none; flex-grow: 1;" placeholder="If you are looking for the legacy version, type -1 in the sorting number box." required></textarea>
	<div style="width: 37.5%;">
	<select name="sort" id="sort" required>
		<option value="0"> number of names per group </option>
		<option value="1"> number of groups </option>
	</select>
	<input style="margin: 10px;" type="number" id="number" name="number" min="1" required>
	</div>
	<input style="font-size: x-large;" type="button" value="Submit" onclick="sort()">
</body>
<script>
function shuffleArray(array) {
    for (var i = array.length - 1; i > 0; i--) {
        var j = Math.floor(Math.random() * (i + 1));
        var temp = array[i];
        array[i] = array[j];
        array[j] = temp;
    }
}

function randomInRange(min, max) {
  return Math.random() * (max - min) + min;
}

var textarea = document.getElementById("names");

function sort() {
  var names = document.getElementById("names").value.split("\n")
	var boton = false;
	if(names.includes("boston")) boton = true;
	if(names.includes("Boston")) boton = true;
	shuffleArray(names);
	var num = document.getElementById("number").value
	num = Math.round(num);
	if(num == -1) {
		window.location.href = "https://qqwwertyuiop.github.io/groupSorter/legacy.html";
		return;
	}
	if(num <= 0) {
		alert("Number must be a positive integer!");
		return;
	}
	var namesPerGroup = 0;
	var numGroups = 0;
  if(document.getElementById("sort").selectedIndex == 0) {
		namesPerGroup = num;
		numGroups = Math.floor(names.length/num);
  } else {
    namesPerGroup = Math.floor(names.length/num);
		numGroups = num;
  }
	if(numGroups > names.length) {
		alert("Number of groups cannot exceed number of names!");
		return;
	}
	var groups = [];
	for(i=0; i<numGroups; i++) {
		groups.push([])
		for(j=0; j<namesPerGroup; j++) {
			groups[i].push(names.pop())
		}
	}
	names.forEach((element, i) => {
		groups[i].push(element)
	})
	outStr = ""
	groups.forEach((element, i) => {
		outStr += `Group ${i+1}: [${element.join(', ')}]\n`
	});
	if(boton) {
		var img = document.createElement("IMG");
		var imgs = ["majesty.png", "majesty.png", "majesty.png", "nerd.png"]
		img.setAttribute("src", imgs[Math.floor(4*Math.random())]);
		img.setAttribute("id", "boton")
		document.body.insertBefore(img, document.body.children[0]);
	}
	var textElmt = document.getElementById("text")
	textElmt.innerText = outStr;
	document.querySelector(':root').style.setProperty('--textHeightCurrent', textElmt.clientHeight)
	document.querySelector(':root').style.setProperty('--textHeightNew', groups.length*22 + 'px')
	textElmt.classList.add("textAppear")

	var posList = [0.125, 0.375, 0.625, 0.875]
	posList.forEach(pos => {
		confetti({
			angle: 270,
			spread: 75,
			particleCount: 50,
			origin: {x: pos, y: -0.25},
			startVelocity: 50,
		});
	});
}
</script>
